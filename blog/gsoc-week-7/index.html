<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> [GSoC 2016] CKEditor plugins - 7. week -Saša Nikolič </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="keywords" content="[GSoC 2016] CKEditor plugins - 7. week, Saša Nikolič, gsoc-2016,drupalplanet, gsoc, drupal, ckeditor plugins, translation"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="Saša Nikolič" property="og:site_name" /> <meta content="[GSoC 2016] CKEditor plugins - 7. week" property="og:title" /> <meta content="article" property="og:type" /> <meta content="This is my window to the open internet world." property="og:description" /> <meta content="/blog/gsoc-week-7/" property="og:url" /> <meta content="2016-07-12T15:50:00+00:00" property="article:published_time" /> <meta content="/about/" property="article:author" /> <meta content="/assets/img/google-summer-of-code.png" property="og:image" /> <meta content="gsoc-2016" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="[GSoC 2016] CKEditor plugins - 7. week" /> <meta name="twitter:url" content="/blog/gsoc-week-7/" /> <meta name="twitter:description" content="This is my window to the open internet world." /> <link rel="stylesheet" href="/assets/css/main.css" /> <!-- <link rel="stylesheet" href="/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = '' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="/assets/js/search.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!-- buy me a coffeee --> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sasanikolic90" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="right" data-x_margin="10" data-y_margin="10" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">Saša Nikolič</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="/contact" >Contact</a > </li> </ul> </div> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() " type="checkbox" name="checkbox" /> </li> </ul> </nav> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="col-lg-12"> <div class="row" id="blog-post-container"> <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">[GSoC 2016] CKEditor plugins - 7. week</h1> <h4 class="post-meta"></h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="/blog/authors/sasanikolic">sasanikolic</a></span> </span > at <time datetime="2016-07-12 15:50:00 +0000" itemprop="datePublished" >Jul 12, 2016</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/gsoc-week-7/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/gsoc-2016" >gsoc-2016</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="/assets/img/google-summer-of-code.png" alt="" /> <br /> <br /> <p>With the time passing by, my final product for the Google Summer of Code 2016 is starting to get the shape. The user’s workflow for the translation with <a href="https://www.drupal.org/project/tmgmt">TMGMT</a> will be easier than ever with the CKEditor plugins that I am working on for this summer project. I clearly divided the content into segments and displayed them in the editor before the midterm evaluation period in my first segments plugin. You can read more about that in my blog post from week 5 - <a href="http://sasanikolic.com/gsoc-2016/gsoc-ckeditor-plugins-5-week/">here</a>.</p> <p>The second plugin called <code class="language-plaintext highlighter-rouge">tags</code> is currently being developed. With it, we want to mask HTML tags inside segments, so that the user can get a better idea of the structure of the content, see which tags are set, opened and check, if they are properly closed.</p> <h2 id="achievements">Achievements</h2> <p>The seventh week was in a sign of blockers - parts of code that are complex, not yet implemented, not functioning properly or just simply need discussion. I started the week with some code refactoring.</p> <p>We have discussed the structure of the masked tags. We do not support masked tag pairs. Instead, every masked tag will consist of two parts - their opening and closing element.</p> <ul> <li>element - the name of the masked HTML tag</li> <li>raw - contains the encoded tag, together with attributes</li> </ul> <p>This is is our definition of the masked tag’s structure:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">&lt;tmgmt-tag</span> <span class="na">element=</span><span class="s">”b”</span> <span class="na">raw=</span><span class="s">”&amp;lt;b&amp;gt;”</span><span class="nt">&gt;</span>This is a masked tag<span class="nt">&lt;tmgmt-tag</span> <span class="na">element=</span><span class="s">”b”</span> <span class="na">raw=</span><span class="s">”&amp;lt;/b&amp;gt;”</span><span class="nt">&gt;</span>
<span class="nt">&lt;tmgmt-tag</span> <span class="na">element=</span><span class="s">”img”</span> <span class="na">raw=</span><span class="s">”&amp;lt;img</span> <span class="na">src=</span><span class="s">...</span> <span class="na">alt=</span><span class="s">...</span> <span class="na">title=</span><span class="s">...&amp;gt;”</span><span class="nt">&gt;</span>

</code></pre></div></div> <p>The reasons for this redefinition are many. Firstly, it is really important that the editor displays the masked tags properly with their respective names. This is why we have the <code class="language-plaintext highlighter-rouge">element</code> attribute inside the tag. Secondly, the raw attribute contains the encoded tag. In the case when the tag has some attributes like <code class="language-plaintext highlighter-rouge">src</code>, <code class="language-plaintext highlighter-rouge">alt</code> and <code class="language-plaintext highlighter-rouge">title</code>, we will easily get them from here, decode them, and display them to the user when the tag is clicked. The downside is, this makes these attributes untranslatable and they will be just placed back untranslated. When unmasking, the process will simply replace <code class="language-plaintext highlighter-rouge">&lt;tmgmt-tag&gt;</code> with its raw property. Last, but not least, this structure helps us when looking for open and closed tags inside segments.</p> <p>Also note, the tags above are different. The first one is a tag that requires a closing pair, the second one is a single tag (could also be <code class="language-plaintext highlighter-rouge">&lt;br /&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;hr /&gt;</code> etc.). If the closing pair of a tag would be missing, we’d color the tag’s border in red as a sign of warning.</p> <p>As mentioned before, I stumbled upon some blockers during this week. The first one was an issue related to closing the tags. Since I created some dummy segments with masked tags inside, the editor’s behaviour was expected. The tags didn’t have their closing elements (<code class="language-plaintext highlighter-rouge">&lt;/tmgmt-tag&gt;</code>), so they were added automatically. My mentor pointed me out to check how the <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> tag is defined in CKEditor. We found out that this is defined the <code class="language-plaintext highlighter-rouge">CKEDITOR.dtd</code> object, which holds the representation of the HTML DTD to be used by the editor in its internal operations. I need to define the tag in the <code class="language-plaintext highlighter-rouge">$empty</code> object, which contains the list of empty (self-closing) elements.</p> <p>I also started working on the topic of perfect matching. This consists of getting the translation of a segment from the <a href="https://www.drupal.org/sandbox/edurenye/2715815">translation memory</a> and checking for a full match. This means, that the text and the HTML structure of a selected segment both match with the translation in the memory. Fuzzy matching would be, if only one of that would match. The segments in the memory are unmasked, while we can only get the masked segments from the editor and send them through the HTTP request to the service.</p> <p>The workflow of masking the tags would be the following:</p> <ol> <li>Mask the tags when the editor loads.</li> <li>Send the masked tag through the HTTP request to the service controller.</li> <li>Unmask the tag.</li> <li>Query for the translation in the memory.</li> <li>If we have a match, mask it.</li> <li>Return it.</li> </ol> <p>The problem is that the masking and unmasking functions are not supported in tmgmt yet. Remember, I wrote the dummy segments with some masked tags in the <code class="language-plaintext highlighter-rouge">tmgmt_ckeditor.install</code> file solely for the purpose of testing. Hopefully, this will be done and committed in the following days, so I can continue my work on that part.</p> <p>I also did some improvements, like fixing the dependency to the segments plugin, display the tags in the editor pairs properly and made the tags look nicer by adding some CSS styles.</p> <h2 id="goals-for-next-week">Goals for next week</h2> <p>The plan for next week is to fix the blockers described above and to fully restructure my code. I created a prototype object last week (<a href="http://sasanikolic.com/gsoc-2016/gsoc-ckeditor-plugins-6-week/">described here</a>) containing the relevant information of the editor pair. We want to implement all the relevant functions as prototype methods and have them accessible for both plugins, to prevent code duplications and make the code cleaner.</p> <p>My GSoC project is available in my <a href="https://github.com/sasanikolic90/tmgmt_ckeditor/">Github repository</a>.</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="/blog/gsoc-week-7/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About Saša Nikolič </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="/assets/img/authors/sasa.png" alt="Saša Nikolič" /> </div> <div class="col-md-6"> <p class="author_bio">Web Developer. Occasionally, I write blogs and present publicly.</p> <p>Email : nikolic.sasa09@gmail.com</p> <p>Website : https://www.sasanikolic.com</p> <p class="profile-links"> <a class="social-link" href="https://github.com/sasanikolic90" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/saša-nikolič-62399992" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.facebook.com/sasanikolic123" target="_blank"><i class="fab fa-facebook fa-fw"></i></a> <a class="social-link" href="https://www.twitter.com/sasanikolic90" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> <a class="social-link" href="https://instagram.com/sasha.nklc" target="_blank"><i class="fab fa-instagram fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "/blog/gsoc-week-7/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/gsoc-ckeditor-plugins-7-week"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://sasanikolic.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About Saša Nikolič</div> <div class="card-body"> <p class="author_bio">I'm a Front-End Drupal Developer for MD Systems working remotely. I have serious passion for UI effects, animations and creating intuitive, dynamic user experiences. I love structure and order and I also stand for quality.</p> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#gsoc-2016"></div> <li class="tag-head"> <a href="/blog/categories/gsoc-2016">gsoc-2016</a> </li> <a name="gsoc-2016"></a> <div id="#paragraphs"></div> <li class="tag-head"> <a href="/blog/categories/paragraphs">paragraphs</a> </li> <a name="paragraphs"></a> <div id="#tech-2021"></div> <li class="tag-head"> <a href="/blog/categories/tech-2021">tech-2021</a> </li> <a name="tech-2021"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="/">Home</a> </li> <li> <a href="/about">About</a> </li> <li> <a href="/blog">Blog</a> </li> <li> <a href="/contact">Contact</a> </li> </div> </div> </div> </div> </div><footer> <p> Powered by <a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>. Subscribe via <a href=" /feed.xml ">RSS</a>.</p> </footer> <script> var options = { classname: 'my-class', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="/assets/js/mode-switcher.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
